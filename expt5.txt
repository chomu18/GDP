// Expt 5 : Build a NodeMCU ESP8266-based web-server to control LEDs
#include <ESP8266WiFi.h>
#include <ESP8266WebServer.h>
// ====== Wi-Fi credentials (change these) ======
const char* ssid = "Siddhu_4G";
// <-- Enter your Wi-Fi name
const char* password = "Riddhi204"; // <-- Enter your Wi-Fi password
// ====== GPIO pins ======
const int led1 = 5;
// D1 → GPIO5
const int led2 = 4;
// D2 → GPIO4
ESP8266WebServer server(80);
// ====== HTML Template stored in Flash (saves RAM) ======
const char MAIN_page[] PROGMEM = R"rawliteral(
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ESP8266 LED Control</title>
<link
href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
rel="stylesheet">
<style>
body {
font-family:'Poppins',sans-serif;text-align:center;padding:20px;background:#cce7ff;
color:#222; }
.card {
display:inline-block;padding:20px;margin:15px;background:#f8f9fa;border-radius:15px
;box-shadow:0 2px 5px rgba(0,0,0,0.2);}
.switch { position:relative;display:inline-block;width:60px;height:34px; }
.switch input { opacity:0;width:0;height:0; }
.slider {
position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background:#e74c3c;t
ransition:0.4s;border-radius:34px; }
.slider:before {
position:absolute;content:"";height:26px;width:26px;left:4px;bottom:4px;background:
white;border-radius:50%;transition:0.4s; }
input:checked + .slider { background:#2ecc71; }
input:checked + .slider:before { transform:translateX(26px); }
footer { margin-top:40px;font-weight:bold; }
</style>
</head>
<body>
<h2>ESP8266 LED Controller</h2>
<div class="card">
<h3>LED 1 (GPIO5)</h3>

<label class="switch">
<input type="checkbox" onclick="toggleLED(1,this)">
<span class="slider"></span>
</label>
</div>
<div class="card">
<h3>LED 2 (GPIO4)</h3>
<label class="switch">
<input type="checkbox" onclick="toggleLED(2,this)">
<span class="slider"></span>
</label>
</div>
<footer>
Pragati Patil | Roll No: 311047 | TY E&TC A
</footer>
<script>
function toggleLED(id, el) {
fetch("/toggle?id=" + id);
}
setInterval(()=>{ location.reload(); }, 5000);
</script>
</body>
</html>
)rawliteral";
// ====== Generate HTML (fetched from Flash) ======
String generateHTML() {
return FPSTR(MAIN_page);
}
// ====== Handle root ======
void handleRoot() {
server.send(200, "text/html", generateHTML());
}
// ====== Toggle LED ======
void handleToggle() {
int id = server.arg("id").toInt();
int pin = (id == 1) ? led1 : led2;
digitalWrite(pin, !digitalRead(pin));
server.sendHeader("Location", "/");
server.send(303);
}
// ====== Setup ======
void setup() {
Serial.begin(9600);
pinMode(led1, OUTPUT);
pinMode(led2, OUTPUT);
digitalWrite(led1, LOW);
digitalWrite(led2, LOW);
// Connect to Wi-Fi
Serial.print("\nConnecting to ");

Serial.println(ssid);
WiFi.begin(ssid, password);
while (WiFi.status() != WL_CONNECTED) {
delay(500);
Serial.print(".");
}
Serial.println("\nWiFi connected!");
Serial.print("IP Address: ");
Serial.println(WiFi.localIP());
// Setup routes
server.on("/", handleRoot);
server.on("/toggle", handleToggle);
server.begin();
Serial.println("HTTP server started");
}
// ====== Loop ======
void loop() {
server.handleClient();
}

